<div class="row">
    <div class="col-md-12">
        <div class="box box-primary">
            <form class="form-horizontal dataForm"  method="post" enctype="multipart/form-data">
                <input type="hidden" id="id" value="{$info.id}" >

                <div class="box-body">
                    <div class="fields-group">

                        <div class="form-group">
                            <label for="title" class="col-sm-2 control-label">网站标题</label>
                            <div class="col-sm-10 col-md-10">
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-user"></i></span>
                                    <input  id="title" name="title" value="{$info.title}" class="form-control" placeholder="网站标题">
                                </div>
                            </div>
                        </div>


                        <div class="form-group">
                            <label for="modou" class="col-sm-2 control-label">首页模板</label>
                                <div class="input-group iconpicker-container">
                                    默认模板： <input type="radio" name="modou" {eq name="$info.modou" value="1"} checked="" {/eq}   value="1">
                                    商城模板： <input type="radio" name="modou" {eq name="$info.modou" value="2"} checked="" {/eq}   value="2">
                                </div>
                        </div>

                        <div class="form-group">
                            <label for="images" class="col-sm-2 control-label">导航栏图片</label>
                            <div class="col-sm-10 col-md-4">
                                <div class="input-group iconpicker-container">
                                    <input type="file" class="layui-btn" name="uploadImg" id="uploadImg" onchange="UploadImages();" />
                                    <div class="timeline-body">

                                        <img style="width:150px;height:100px;" src="{$info.images|default='http://placehold.it/150x100'}" id="img1" class="margin">

                                        <input type="hidden" id="images" value="{$info.images}">
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="form-group">
                            <label for="images" class="col-sm-2 control-label">网站logo</label>
                            <div class="col-sm-10 col-md-4">
                                <div class="input-group iconpicker-container">
                                    <input type="file" class="layui-btn" name="uploadImg1" id="uploadImg1" onchange="UploadLogo();" />
                                    <div class="timeline-body">

                                        <img style="width:150px;height:100px;" src="{$info.logo|default='http://placehold.it/150x100'}" id="img2" class="margin">

                                        <input type="hidden" id="logo" value="{$info.logo}">
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="form-group">
                            <label for="images" class="col-sm-2 control-label">手机二维码</label>
                            <div class="col-sm-10 col-md-4">
                                <div class="input-group iconpicker-container">
                                    <input type="file" class="layui-btn" name="uploadImg2" id="uploadImg2" onchange="UploadQcode();" />
                                    <div class="timeline-body">

                                        <img style="width:150px;height:100px;" src="{$info.qcode|default='http://placehold.it/150x100'}" id="img3" class="margin">

                                        <input type="hidden" id="qcode" value="{$info.qcode}">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="title" class="col-sm-2 control-label">网站关键字</label>
                            <div class="col-sm-10 col-md-10">
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-user"></i></span>
                                    <input  id="keywords" name="keywords" value="{$info.keywords|default=''}" class="form-control" placeholder="网站关键字">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="title" class="col-sm-2 control-label">网站描述</label>
                            <div class="col-sm-10 col-md-10">
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-user"></i></span>
                                    <input  id="miao" name="miao" value="{$info.miao|default=''}" class="form-control" placeholder="网站描述">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="title" class="col-sm-2 control-label">客服qq</label>
                            <div class="col-sm-10 col-md-6">
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-user"></i></span>
                                    <input  id="kefu" name="kefu" value="{$info.kefu}" class="form-control" placeholder="客服qq">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="title" class="col-sm-2 control-label">qq群1</label>
                            <div class="col-sm-10 col-md-6">
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-user"></i></span>
                                    <input  id="qq1" name="qq1" value="{$info.qq1}" class="form-control" placeholder="">
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="title" class="col-sm-2 control-label">qq群2</label>
                            <div class="col-sm-10 col-md-6">
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa fa-user"></i></span>
                                    <input  id="qq2" name="qq2" value="{$info.qq2}" class="form-control" placeholder="">
                                </div>
                            </div>
                        </div>


                        <div class="form-group">
                            <label for="title" class="col-sm-2 control-label">底部说明</label>
                            <div class="col-sm-10 col-md-7">
                                <div class="input-group">
                                    <span class="input-group-addon"><i class="fa  fa-television"></i></span>
                                    <textarea  name="content" id="content" class="form-control" rows="5" placeholder="Enter ...">{$info.info}</textarea>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="box-footer">
                    <div class="col-sm-2">
                    </div>
                    <div class="col-sm-10 col-md-4">
                        <div class="btn-group">
                            <button type="button" class="btn flat btn-info dataform-submit addg">保存</button>
                        </div>
                        <div class="btn-group">
                            <button type="reset" class="btn flat btn-default dataform-reset">重置</button>
                        </div>
                    </div>
                </div>

            </form>
        </div>
    </div>
</div>

<script>
    function UploadImages(){
        var formdata = new FormData();

        var url = "{:url('wconfig/UploadImg')}";
        // 将文件追加到 formdata对象中。
        formdata.append("file",document.getElementById('uploadImg').files[0]);
        $.ajax({
            type: "POST",
            url: url,
            data:formdata,
            processData: false,
            contentType: false,
            dataType: "json",
            success: function (data) {
                if (data.code == '200') {
                    layer.msg(data.msg,{time:1000},function(){
                        $("#images").val(data.path);
                        $("#img1").attr('src',data.path);
                    })
                };

                if(data.code == '400'){
                    layer.msg(data.msg,{time:1500},function(){
                        location.reload();
                    });
                }


            },
            error: function(data){
                console.log(data);
            },
        });
    }

    function UploadLogo(){
        var formdata = new FormData();

        var url = "{:url('wconfig/UploadImg')}";
        // 将文件追加到 formdata对象中。
        formdata.append("file",document.getElementById('uploadImg1').files[0]);
        $.ajax({
            type: "POST",
            url: url,
            data:formdata,
            processData: false,
            contentType: false,
            dataType: "json",
            success: function (data) {
                if (data.code == '200') {
                    layer.msg(data.msg,{time:1000},function(){
                        $("#logo").val(data.path);
                        $("#img2").attr('src',data.path);
                    })
                };

                if(data.code == '400'){
                    layer.msg(data.msg,{time:1500},function(){
                        location.reload();
                    });
                }


            },
            error: function(data){
                console.log(data);
            },
        });
    }


    function UploadQcode(){
        var formdata = new FormData();

        var url = "{:url('wconfig/UploadImg')}";
        // 将文件追加到 formdata对象中。
        formdata.append("file",document.getElementById('uploadImg2').files[0]);
        $.ajax({
            type: "POST",
            url: url,
            data:formdata,
            processData: false,
            contentType: false,
            dataType: "json",
            success: function (data) {
                if (data.code == '200') {
                    layer.msg(data.msg,{time:1000},function(){
                        $("#qcode").val(data.path);
                        $("#img3").attr('src',data.path);
                    })
                };

                if(data.code == '400'){
                    layer.msg(data.msg,{time:1500},function(){
                        location.reload();
                    });
                }


            },
            error: function(data){
                console.log(data);
            },
        });
    }


</script>

<script>
    $('.addg').click(function(){
        var dat      = {};
        dat.title    = $('#title').val();
        dat.modou    = $("input[name='modou']:checked").val();
        dat.images   = $('#images').val();
        dat.logo     = $('#logo').val();
        dat.qcode    = $('#qcode').val();
        dat.keywords = $('#keywords').val();
        dat.miao     = $('#miao').val();
        dat.kefu     = $('#kefu').val();
        dat.qq1      = $('#qq1').val();
        dat.qq2      = $('#qq2').val();
        dat.content  = $('#content').val();
        dat.id       = $('#id').val();

        if( dat.title=='' || dat.title ==undefined ){
            layer.msg('商品名称不能为空',{time:2000});
            return false;
        }
        var url = "{:url('wconfig/setconfig')}";

        $.post(url,{dat:dat},function(ret){
            if(ret.code == '200'){
                layer.msg(ret.msg,{time:2000},function(){
                    parent.location.reload();
                });
            };
            if(ret.code == '400'){
                layer.msg(layer.msg,{time:2000},function(){
                    parent.location.reload();
                })
            }
        },'json');
    });
</script>
